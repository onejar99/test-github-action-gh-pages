name: Build and deploy gh-pages

on:
  push:
    branches:
      - master
    paths:


jobs:
  build-and-deploy-book1:
    name: Build and deploy gh-pages
    on:
      paths:
      - 'book_src_1/*'
    runs-on: ubuntu-latest
    env:
      MY_SECRET   : ${{secrets.GH_ACCESS_TOKEN}}

    steps:
    - name: Checkout 🛎️
      uses: actions/checkout@v2.3.1
      with:
        persist-credentials: false

    - name: Build 🔧
      run: |
        echo "pwd=[$(pwd)]"
        ls -al
        cd book_src_1
        docker run --rm -p 4000:4000 -v $(pwd):/gitbook onejar99/gitbook:light "gitbook init && gitbook install && gitbook build"

    - name: Deploy 🚀
      uses: JamesIves/github-pages-deploy-action@3.5.7
      with:
        GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}
        BRANCH: gh-pages
        FOLDER: book_src_1/_book

